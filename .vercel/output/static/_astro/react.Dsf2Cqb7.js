import{e as j,r as C}from"./index.DlAYGZ0P.js";const B=t=>{if(!t)return;const{attributes:e,element:o,elementName:i,value:n}=t,r=o||document.createElement(i||"div");if(e&&r instanceof HTMLElement)for(const[s,l]of Object.entries(e))r.setAttribute(s,String(l));if(n)if(typeof n=="string")r.innerHTML=n;else for(const s of Array.isArray(n)?n:[n]){const l=B(s);l&&r.appendChild(l)}return r},Rt=/px$/,Y=t=>Number(t.replace(Rt,"")),D=typeof document<"u",vt=()=>{},q=(t,{filter:e,defaultValue:o}={})=>i=>{let n;return i&&`${i}`.replace(t,(r,s)=>n=s),(e?e(n):n)||o},F=t=>{throw new Error((e=>`twicpics-components ${e}`)(t))},x=(t,{border:e="\\s",regExpFlags:o}={})=>new RegExp(`^(?:${e})*(${Array.isArray(t)?t.join("|"):t})(?:${e})*$`,o),pt={breakpoints:{xs:320,sm:640,md:768,lg:1024,xl:1280,"2xl":1536},class:"twic",domain:void 0,env:"production",handleShadowDom:vt,maxDPR:void 0,path:"",step:void 0},mt=D&&window,a=D?mt["~ TPCC"]||(mt["~ TPCC"]=pt):pt,wt=()=>`.twic-w>.${a.class}-background-done+div,.twic-w>.${a.class}-done+div,.twic-w>.${a.class}-poster-done+div{opacity:0 !important}.twic-w>.${a.class}-done,.twic-w>.${a.class}-poster-done{transform:none !important}`,y=t=>`data-${a.class}-${t}`,At=t=>{const{breakpoints:e={},debug:o,domain:i,class:n,env:r,handleShadowDom:s,maxDPR:l,path:f}=t;a.breakpoints=Object.assign(Object.assign({},a.breakpoints),e),a.class=n||a.class,a.domain=i,a.env=o?"debug":r,a.maxDPR=Math.max(1,l||2),a.path=f,a.handleShadowDom=s&&D?(p=>{const g=new WeakSet;return c=>{for(;c&&!g.has(c);){g.add(c);const{parentNode:m}=c;if(!m&&c instanceof ShadowRoot){if(c.mode==="closed")throw new Error("cannot use TwicPics components in closed ShadowRoot");B({element:c,value:{elementName:"style",value:`.twic-i{overflow:hidden}.twic-w,.twic-w *{border:none;margin:0;overflow:hidden;padding:0}.twic-w{overflow:hidden;position:relative;padding-top:100%;width:100%;padding-top:calc(100% / var(--twic-ratio,1))}.twic-w>*{display:block;height:100%;left:0;position:absolute;top:0;width:100%;transition-property:opacity,transform;will-change:opacity,transform;background-size:cover;background-position:center;background-repeat:no-repeat;object-fit:cover;object-position:center;transition-delay:0s;transition-duration:.4s;transition-timing-function:ease;object-fit:var(--twic-mode,cover);object-position:var(--twic-position,center);transition-delay:var(--twic-transition-delay,0s);transition-duration:var(--twic-transition-duration,400ms);transition-timing-function:var(--twic-transition-timing-function,ease)}.twic-w>div{background-repeat:no-repeat;background-size:cover;background-position:center;background-size:var(--twic-mode,cover);background-position:var(--twic-position,center);font-size:calc(1px / var(--twic-ratio,1))}.twic-w>img:not([src]),.twic-w>img[src=""]{visibility:hidden}.twic-w.twic-tz>img{transform:scale(0)}.twic-w.twic-tf>div{opacity:1}.twic-d{display:block}.twic-offline{background-color:#ccc}.twic-offline.twic-nosrc{background-color:#fd0016}.twic-offline>*{display:none}:root{--twic-zoom:0}.twic-z{position:relative}.twic-m{left:0;position:absolute;top:0;z-index:1}.twic-m>*{display:none;transition:none;width:calc(max(var(--twic-zoom),1) * 100%);height:calc(max(var(--twic-zoom),1) * 100%);transform:translate3d(calc((1 - max(var(--twic-zoom),1)) * var(--twic-xr,0) * 1px),calc((1 - max(var(--twic-zoom),1)) * var(--twic-yr,0) * 1px),0)}.twic-m:hover>*{display:block}.twic-m:hover+div,twicmedia:hover+twicmedia{opacity:0}.twic-p{border:none;margin:0;overflow:hidden;padding:0}.twic-p>img{display:block;object-fit:cover;object-position:center;width:100%;height:100%}${wt()}`}}),(c=c.host)&&c.setAttribute(p,"")}else c=m}}})(y("component")):vt},bt=/^(?:(auth|placeholder|rel)|(image|media|video)|[^:]*):(\/*)((v[0-9]+(?=[/?]))?[^?]*(\?.*)?)$/,Q=(t,e="")=>{const o=t&&bt.exec(t);return{isAbsolute:t.slice(0,e.length+1)===`${e}/`,isSpecial:o&&o[1]!==void 0}},Ht=({domain:t,context:e,inspect:o,output:i,quality:n,src:r,transform:s})=>{const{isAbsolute:l}=Q(r,t),f=l?`media:${r.slice(`${t}/`.length)}`:r,p=bt.exec(f),g=p&&p[2],c=i?`/output=${i}`:"",m=g?p[4]:f,N=n?`/quality=${n}`:"",k=o?"/inspect":"",v=(({height:b,mode:S="cover",width:T},z)=>{if(z&&(T||b)){const O=b||"-",E=T||"-";return z.replace(/(\/*\*)/g,`/${S}=${E}x${O}`).replace(/WxH/g,`${E}x${O}`)}return z})(e,s);return`${t}/${p&&(p[1]||p[5])?`v1${v}${c}${N}${k}/${g?`${p[2]}:${m}`:m}`:`${m}${p&&p[6]?"&":"?"}twic=v1${v}${c}${k}${N}`}`},$t=(t,e)=>(t||"cover")==="cover"&&e!==void 0?"":"/*",I=["center"];for(const t of["","bottom","top"])for(const e of["","left","right"])(e||t)&&I.push(t?e?`${t}-${e}`:t:e);const Ft=/\?|^\/*$/;x(I);const _=/(^https?:\/\/[^/]+)\/*$/;x(["high","low","auto"]);const Wt=x("\\s*(\\d+)\\s*[x]\\s*(\\d+)\\s*"),yt=["contain","cover"],Lt=x(yt),xt=["maincolor","meancolor","none","preview"],Bt=x(xt),Vt=/^\/*(.+?)\/*$/,qt=x("(\\d+(?:\\.\\d+)?)(?:\\s*[\\/:]\\s*(\\d+(?:\\.\\d+)?))?|(none)"),kt=x(["debug","offline","production"]),It=x("(\\d+\\.?\\d*)|(css)",{regExpFlags:"i"}),Z=t=>!isNaN(t)&&t>0,Jt=/^((image|media|video):)?\/*/,h=q(x(`(?:.|
)+?`)),Kt=x(".+?",{border:"[\\s\\/]"}),Ut={true:!0,false:!1,"":!0},St=t=>typeof t=="boolean"?t:t!==void 0&&Ut[t.trim()],Xt=t=>{if(typeof t!="number"){const e=h(t);t=e&&Number(e)}return Z(t)?t:void 0},Yt=/\b(?:(left|right)|(bottom|top))\b/g,_t=t=>{const e=h(t);let o,i;if(e){let n;for(;n=Yt.exec(e);)n[1]?o=n[1]:i=n[2]}return{x:o,y:i}},Gt=t=>h(t)||"",Tt=h,Qt=t=>{const e=h(t);return _.test(e)?e.replace(_,"$1"):void 0},Zt=St,te=q(kt),ee=t=>{const e=h(t);return e==="none"?"":e},Nt=q(Lt),oe=t=>{const e=h(t);return e?e.replace(Vt,"$1/"):""},ie=h,ne=t=>{const e=q(Kt,{filter:o=>o&&o.replace(/^\/*(.*[^/])\/*$/,"$1")})(t);return e==="none"?"":e},re=t=>{if(t==="none")return 0;let e;if(t)if(typeof t=="number")e=1/t;else{const o=qt.exec(t);if(o){const[,,i,n]=o;e=(n?Number(n):1)/Number(i)}else e=1}return Z(e)?e:void 0},se=t=>{const e=St(t);if(e===void 0){const o=h((t||"").toString());return o&&o.replace(/\s/g,"")}return e?"":void 0},ae=Xt,ce=t=>{if(a.env==="offline")return"";const e=h(t)||"placeholder:red",{isAbsolute:o,isSpecial:i}=Q(e,a.domain);return i?e:o?`media:${e.slice(`${a.domain}/`.length)}`:e.replace(Jt,`media:${a.path}`)},de=t=>t&&t.trim(),le={true:"fade",false:"none",fade:"fade",zoom:"zoom",none:"none"},pe=h,me=h,ue=h,ut=t=>{if(typeof t=="string"){const e=It.exec(t);if(e&&e[3])return!0;t=e&&e[2]?Number(e[2]):void 0}return Z(t)&&t>1?t:void 0},fe=[["anticipation","anticipation"],["class","class"],["maxDPR","max-dpr"],["step","step"]],he=t=>{if(D){const e=[`${a.domain}/?v1`];fe.forEach(n=>{const[r,s]=n;t.hasOwnProperty(r)&&t[r]&&e.push(`${s}=${t[r]}`)});const{scriptElementId:o}=t;B({element:document.head,value:[{attributes:{rel:"preconnect",href:a.domain},elementName:"link"},{attributes:Object.assign(Object.assign({async:"",defer:""},o&&{id:o}),{src:e.join("&")}),elementName:"script"}]});const i=B({elementName:"style",value:wt()});document.head.appendChild(i),document.addEventListener("astro:after-swap",()=>document.head.appendChild(i))}},ge=t=>{t||F("install options not provided");const{domain:e,env:o,path:i}=t;e&&_.test(e)||F(`install domain "${e}" is invalid`),i&&Ft.test(i)&&F(`install path "${i}" is invalid`),o&&!kt.test(o)&&F(`install env "${o}" is invalid`)},ve=t=>{ge(t);const{domain:e,env:o,path:i}=t;At(Object.assign(Object.assign({},t),{domain:Qt(e),env:te(o),path:oe(i)})),he(t)};const zt=({x:t,y:e},o,i)=>o==="contain"&&(i||(e?t?`${e} ${t}`:e:t)),Et=({anchor:{x:t,y:e},debug:o,focus:i,mode:n,preTransform:r,refit:s})=>{const l=e?t?`${e}-${t}`:e:t,f=n!=="contain"&&s===void 0&&(i||l),p=((g,c,m)=>m!==void 0&&`${c==="contain"?"auto":"WxH"}${m?`(${m})`:""}${g&&c!=="contain"?`@${g}`:""}`)(l,n,s);return`${o?"/debug":""}${r?`/${r}`:""}${f?`/focus=${f}`:""}${p?`/refit=${p}`:""}`},jt=(t,e,o)=>{const i={};return e&&(i.transitionDuration=e),t&&(i.transitionDelay=t),o&&(i.transitionTimingFunction=o),i},we=(t,e)=>e==="img"?t:void 0,be=(t,e,o,i,n,r,s,l,f,p,g,c,m,N,k)=>{const v=jt(g,c,m);k({anchor:t,focus:e,mode:o,placeholder:i,preTransform:r,ratio:s,refit:l,src:f,transitions:p,videoOptions:N}),o&&(v.backgroundSize=o);const b=zt(t,o,n);return b&&(v.backgroundPosition=b),v},$e={img:"objectPosition",video:"objectPosition"},ye={img:"objectFit",video:"objectFit"},xe=(t,e,o,i,n,r,s)=>{const l=jt(n,r,s),f=zt(t,o,i);return f&&(l[$e[e]||"backgroundPosition"]=f),o&&(l[ye[e]||"backgroundSize"]=o),l},ke=(t,e,o)=>{const i=["twic-w"];return t&&i.push(t),o.hasOwnProperty("none")||(o.hasOwnProperty("fade")&&i.push("twic-tf"),o.hasOwnProperty("zoom")&&i.push("twic-tz")),a.env==="offline"&&(i.push("twic-offline"),e||i.push("twic-nosrc")),i.join(" ")},Se=t=>t===0?{height:"100%",paddingTop:"0"}:{paddingTop:t===void 0?"":100*t+"%"},Te=t=>{const e={};return typeof t!="boolean"&&t&&(e["--twic-zoom"]=`${t}`),e},tt=new WeakMap,ft=D&&typeof MutationObserver<"u"&&new MutationObserver(t=>{for(const{target:e}of t){const o=tt.get(e);o&&o.handleState()}}),W=D&&typeof ResizeObserver<"u"&&new ResizeObserver(t=>{for(const{target:e}of t){const o=tt.get(e);o&&o.refreshBackground()}}),Ne=new RegExp(`(?:\\s*)(?:${a.class}(?:-background)*-)(done|error|loading)`);class ze{constructor(e=void 0){this.handleState=()=>{if(this.stateHandler){let o="new";const{className:i}=this.media,n=Ne.exec(i);n&&([,o]=n),this.stateHandler(o)}},this.refreshBackground=((o,i)=>{let n;const r=Object.assign({leading:!0,ms:0,trailing:!0},{ms:100});return(...s)=>{!n&&r.leading&&o(...s),clearTimeout(n),n=setTimeout(()=>{n=void 0,r.trailing&&o(...s)},r.ms)}})(()=>{if(this.media&&this.placeholderData){const o=this.media.nextElementSibling,i=((n,{anchor:r,focus:s,mode:l,placeholder:f,preTransform:p,src:g,ratio:c,refit:m,transitions:N,videoOptions:k})=>{if(!a.domain||!n||!f||N.hasOwnProperty("zoom"))return"";const v=getComputedStyle(n),b=l||Nt(v.backgroundSize)||"cover";let S;S=c===0?b==="contain"?1:Y(v.height)/Math.max(1,Y(v.width)):c??Y(v.fontSize);let T=1e3,z=1e3;S<1?T*=S:z/=S;const{videoTransform:O}=k||{},E=`${Et({anchor:r,focus:s,mode:l,preTransform:p,refit:m})}${O||""}${$t(b,m)||""}`;return Ht({context:{height:Math.max(1,Math.round(T)),mode:b,width:Math.max(1,Math.round(z))},domain:a.domain,transform:E,src:g,output:f})})(o,this.placeholderData);i&&i!==this.savedWrapperBackground&&(this.savedWrapperBackground=i,o.style.backgroundImage=`url(${JSON.stringify(i)})`)}}),this.setMedia=o=>{o&&(a.handleShadowDom(o),this.media=o,tt.set(this.media,this),ft&&(ft.observe(this.media,{attributes:!0,attributeFilter:["class"]}),this.handleState()),W&&W.observe(this.media))},this.setPlaceholderData=o=>{this.placeholderData=o,this.media&&this.refreshBackground()},this.destroy=()=>{this.media&&this.media&&W&&W.unobserve(this.media)},this.stateHandler=e}}const Ot=t=>t==null;class et extends Error{constructor({componentName:e,expectedTypes:o,expectedValues:i,props:n,propName:r}){const s=o||i;super(`Invalid prop '${r}'${i?` value '${n[r]}'`:""}${o?` type '${typeof n[r]}'`:""} supplied to '${e}'${s?` expected ${s.length>1?"one of ":""}${o?"type ":""}'${s.join(", ")}'`:""}.`),this.expected=s&&s[0]}}const Pt=t=>(e,o,i)=>{const n=[];for(const r of t){const s=r(e,o,i);if(s===null)return null;n.push(s.expected)}return new et({componentName:i,expectedTypes:n,props:e,propName:o})},J=(t,e)=>(o,i,n)=>{const r=o[i],s={componentName:n,props:o,propName:i};return Ot(r)||typeof r===t?null:new et(Object.assign(Object.assign({},s),{expectedTypes:[t]}))},R=J("boolean"),Ee=J("function"),L=t=>{const e=new Set(t);return(o,i,n)=>{const r=o[i];return Ot(r)||e.has(r)?null:new et({componentName:n,expectedValues:t,props:o,propName:i})}},A=Pt,d=J("string"),V=Pt([J("number"),d]),G=t=>{const e=C.useRef(null),o=C.useRef(new ze(u=>{t.onStateChange&&t.onStateChange({target:e,state:u})})).current;C.useEffect(()=>(o.setMedia(e.current),()=>{o.destroy()}),[]);const i=Gt(t.alt),n=_t(t.anchor),r=typeof(s=t.bot)=="string"?s.trim():void 0;var s;const l=Tt(t.className),f=Zt(t.eager),p=ee(t.focus),g=(u=>{if(!u)return;let w;const P=Wt.exec(u);if(P){const[,,K,H]=P;w=`${K}x${H}`}return w})(t.intrinsic),c=(u=>{const w=h(u);return w&&w.toLowerCase()})(t.mediaTag),m=Nt(t.mode),N=(u=>{if(a.env!=="offline"&&u!=="none")return Bt.test(u)?u:"preview"})(t.placeholder),k=ie(t.position),v=ne(t.preTransform),b=re(t.ratio),S=se(t.refit),T=ce(t.src),z=ae(t.step),O=de(t.title),E=(u=>{typeof u!="boolean"&&(u=h(u)||!0);const w={};return String(u).split(/\s*\+\s*|\s+/).forEach(P=>w[`${le[P]||"fade"}`]=!0),w})(t.transition),ot=pe(t.transitionDelay),it=me(t.transitionDuration),nt=ue(t.transitionTimingFunction),{videoOptions:rt}=t,st=((u,w)=>Q(w,a.domain).isSpecial?void 0:u)(N,T);return j.createElement("div",{suppressHydrationWarning:!0,className:ke(l,t.src,E),style:Se(b),title:O},j.createElement(c,Object.assign({ref:e,alt:we(i,c),style:xe(n,c,m,k,ot,it,nt)},((u,w,P,K,H,U,at,Dt,ct,M,dt,Mt)=>{const $={},{videoTransform:lt,posterTransform:Ct}=Mt||{},X=Et({anchor:u,debug:a.env==="debug",focus:K,mode:at,preTransform:Dt,refit:ct});return(X||lt)&&($[y("transform")]=`${X}${lt||""}${$t(at,ct)||""}`),typeof w=="string"&&($[y("bot")]=w||"/"),P&&($[y("eager")]=""),H&&($[y("intrinsic")]=H),M&&(U==="img"||U==="video"?$[y("src")]=M:$[y("background")]=`url(${M})`),M&&U==="video"&&($[y("poster")]=M,$[y("poster-transform")]=`${X}${Ct||""}/*/output=image`),dt!==void 0&&($[y("step")]=String(dt)),$})(n,r,f,p,g,c,m,v,S,T,z,rt))),st&&j.createElement("div",{suppressHydrationWarning:!0,style:be(n,p,m,st,k,v,b,S,T,E,ot,it,nt,rt,o.setPlaceholderData)}))};G.propTypes={alt:d,anchor:L(I),bot:d,className:d,focus:d,intrinsic:d,mode:L(yt),eager:A([R,d]),onStateChange:Ee,placeholder:L(xt),position:d,preTransform:d,ratio:V,src:d,step:V,title:d,transition:A([R,d]),transitionDelay:d,transitionDuration:d,transitionTimingFunction:d};const ht=(t,e)=>{if(t<0||t>e)return Math.min(Math.max(0,t),e);let o=2*t/e;return o<1?e/2*o**3:(o-=2,e/2*(o**3+2))},gt=t=>{t.preventDefault(),t.stopPropagation();const e=t.currentTarget,{left:o,top:i,right:n,bottom:r}=e.getBoundingClientRect(),{clientX:s,clientY:l}=t instanceof MouseEvent?t:t.touches[0];e.style.setProperty("--twic-xr",ht(s-o,n-o).toString()),e.style.setProperty("--twic-yr",ht(l-i,r-i).toString())},je=t=>{const e=C.useRef(null);C.useEffect(()=>{ut(t.zoom)&&(n=>{const r=n.firstElementChild;r.addEventListener("mousemove",s=>gt(s)),r.addEventListener("touchmove",s=>gt(s))})(e.current)},[]);const o=Tt(t.className)||"",i=ut(t.zoom);return j.createElement("div",{ref:e,className:`twic-i ${o} ${i?"twic-z":""}`,style:Te(i)},i&&j.createElement(G,Object.assign({},t,{className:"twic-m",mediaTag:"div",mode:"cover"})),j.createElement(G,Object.assign({},t,{className:"",mediaTag:"img"})))};je.propTypes={refit:A([R,d]),zoom:V};j.use;L(I),A([R,d]),A([R,d]);const Pe=ve;export{je as d,Pe as h};
